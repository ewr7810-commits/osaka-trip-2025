<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>大阪京都六日冬旅</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Shippori+Mincho:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fcfaf7; /* Washi Paper color */
            color: #433d3c; /* Sumi Ink color */
            -webkit-tap-highlight-color: transparent;
        }
        .font-serif {
            font-family: 'Shippori Mincho', serif;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .glass-nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0,0,0,0.05);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Icons System (Fixed: Inline SVG Components) ---
        const createIcon = (children) => ({ className, ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width="24" 
                height="24" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className} 
                {...props}
            >
                {children}
            </svg>
        );

        const Icons = {
            MapPin: createIcon(<><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z" /><circle cx="12" cy="10" r="3" /></>),
            Utensils: createIcon(<><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" /><path d="M7 2v20" /><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" /></>),
            Train: createIcon(<><rect width="16" height="16" x="4" y="4" rx="2" /><path d="M4 10h16" /><path d="M12 4v8" /><path d="m8 22 2-2" /><path d="m16 22-2-2" /><circle cx="8" cy="16" r="1" /><circle cx="16" cy="16" r="1" /></>),
            Camera: createIcon(<><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z" /><circle cx="12" cy="13" r="3" /></>),
            AlertCircle: createIcon(<><circle cx="12" cy="12" r="10" /><line x1="12" x2="12" y1="8" y2="12" /><line x1="12" x2="12.01" y1="16" y2="16" /></>),
            Sun: createIcon(<><circle cx="12" cy="12" r="4" /><path d="M12 2v2" /><path d="M12 20v2" /><path d="m4.93 4.93 1.41 1.41" /><path d="m17.66 17.66 1.41 1.41" /><path d="M2 12h2" /><path d="M20 12h2" /><path d="m6.34 17.66-1.41 1.41" /><path d="m19.07 4.93-1.41 1.41" /></>),
            Cloud: createIcon(<><path d="M17.5 19c0-1.7-1.3-3-3-3h-1.1c-.1-2.9-2.4-5.2-5.3-5.3-2.6-.1-4.9 1.8-5.3 4.4-.8.1-1.5.8-1.5 1.6 0 .9.8 1.7 1.7 1.7h14.5c.3 0 .5-.1.6-.2l.1-.1.1-.1.1-.1c.6-.7.6-1.7 0-2.3" /></>),
            CloudRain: createIcon(<><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242" /><path d="M16 14v6" /><path d="M8 14v6" /><path d="M12 16v6" /></>),
            ShoppingBag: createIcon(<><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z" /><path d="M3 6h18" /><path d="M16 10a4 4 0 0 1-8 0" /></>),
            Calendar: createIcon(<><rect width="18" height="18" x="3" y="4" rx="2" ry="2" /><line x1="16" x2="16" y1="2" y2="6" /><line x1="8" x2="8" y1="2" y2="6" /><line x1="3" x2="21" y1="10" y2="10" /></>),
            Home: createIcon(<><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" /><polyline points="9 22 9 12 15 12 15 22" /></>),
            Wallet: createIcon(<><path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4" /><path d="M4 6v12c0 1.1.9 2 2 2h14v-4" /><path d="M18 12a2 2 0 0 0-2 2c0 1.1.9 2 2 2h4v-4h-4z" /></>),
            Plane: createIcon(<><path d="M2 12h20" /><path d="M13 12l5-8" /><path d="M6 12l2-5" /><path d="M9 22l-4-5" /><path d="M19 22l-5-5" /><path d="M11 22l2-5" /></>), 
            Phone: createIcon(<><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" /></>),
            Info: createIcon(<><circle cx="12" cy="12" r="10" /><path d="M12 16v-4" /><path d="M12 8h.01" /></>),
            ChevronDown: createIcon(<><path d="m6 9 6 6 6-6" /></>),
            ChevronUp: createIcon(<><path d="m18 15-6-6-6 6" /></>),
            Navigation: createIcon(<><polygon points="3 11 22 2 13 21 11 13 3 11" /></>),
            Star: createIcon(<><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" /></>),
            Thermometer: createIcon(<><path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z" /></>),
            Umbrella: createIcon(<><path d="M12 2v2" /><path d="M12 22v-8" /><path d="M12 4a9 9 0 0 1 9 9H3a9 9 0 0 1 9-9z" /></>)
        };

        const { 
            MapPin, Utensils, Train, Camera, AlertCircle, 
            Sun, Cloud, CloudRain, ShoppingBag, 
            Calendar, Home, Wallet, Plane, Phone, Info,
            ChevronDown, ChevronUp, Navigation, Star, Thermometer, Umbrella
        } = Icons;

        // --- Data: Itinerary with REAL Weather ---
        const itineraryData = [
            {
                day: 1,
                date: "12/2 (二)",
                title: "抵達 & 魔法世界",
                weather: "sunny",  // 晴時多雲
                temp: "9°C - 15°C",
                weatherDesc: "晴時多雲",
                events: [
                    { time: "06:55", title: "小港機場起飛 IT284", type: "transport", location: "Kaohsiung International Airport", notes: "第一航廈 | 記得提前2小時抵達" },
                    { time: "10:40", title: "降落關西機場", type: "transport", location: "Kansai International Airport", notes: "入境後：1人排綠色窗口買小孩ICOCA，1人換Haruka票", highlight: "關鍵分工" },
                    { time: "12:00", title: "移動午餐", type: "food", location: "Haruka Train", notes: "建議在Haruka車上吃便當/飯糰，省時！", mustEat: "超商飯糰/炸雞" },
                    { time: "14:00", title: "飯店放行李", type: "hotel", location: "Hotel Universal Port Vita", notes: "Check-in 15:00後。預訂代號：6501492647" },
                    { time: "15:30", title: "環球影城 入園", type: "sightseeing", location: "Universal Studios Japan", notes: "天氣好！記得先查水世界表演時間", highlight: "快速移動" },
                    { time: "17:30", title: "哈利波特 & 晚餐", type: "food", location: "Three Broomsticks", notes: "三根掃帚餐廳：欣賞城堡夜景 + 聖誕燈光", mustEat: "奶油啤酒、烤雞餐" }
                ]
            },
            {
                day: 2,
                date: "12/3 (三)",
                title: "環球影城 全日攻防",
                weather: "cloudy", // 陰天
                temp: "9°C - 15°C",
                weatherDesc: "陰天",
                events: [
                    { time: "07:30", title: "抵達門口排隊", type: "strategy", location: "Universal Studios Japan", notes: "一入園立刻打開App抽『馬力歐整理券』！", highlight: "最重要的事" },
                    { time: "09:00", title: "好萊塢美夢/飛天翼龍", type: "sightseeing", location: "The Flying Dinosaur", notes: "長輩顧小孩/利用Child Switch輪流玩" },
                    { time: "11:00", title: "午餐：史努比咖啡廳", type: "food", location: "Snoopy's Backlot Cafe", notes: "位於環球奇境，適合小孩，人潮較少", mustEat: "史努比造型包子" },
                    { time: "13:00", title: "哈利波特 & 表演", type: "sightseeing", location: "Wizarding World of Harry Potter", notes: "魔杖互動、15:00庫洛米表演" },
                    { time: "16:00", title: "超級任天堂世界", type: "sightseeing", location: "Super Nintendo World", notes: "依整理券時間入場。必玩：賽車 (排隊久要有心理準備)", highlight: "必玩熱點" },
                    { time: "19:00", title: "晚餐：步行街/外帶", type: "food", location: "Universal CityWalk Osaka", notes: "推薦外帶 551蓬萊肉包 或 Shake Shack 回飯店吃", mustEat: "551肉包" }
                ]
            },
            {
                day: 3,
                date: "12/4 (四)",
                title: "海遊館 & 市場尋寶",
                weather: "rainy", // 陰有短暫雨
                temp: "8°C - 13°C",
                weatherDesc: "陰短暫雨 60%",
                weatherAlert: "出門記得帶傘",
                events: [
                    { time: "09:00", title: "早餐", type: "food", location: "Saint Marc Cafe", notes: "サンマルクカフェ：知名的可頌咖啡店", mustEat: "招牌巧克力可頌" },
                    { time: "10:00", title: "退房 & 寄行李", type: "hotel", location: "Hotel Universal Port Vita", notes: "11:00前退房。使用行李特工寄到『Seian Building』" },
                    { time: "10:30", title: "搭乘船長號", type: "transport", location: "Captain Line", notes: "從環球影城港口搭船直達海遊館，省去電車轉乘" },
                    { time: "11:00", title: "海遊館 (室內躲雨)", type: "sightseeing", location: "Osaka Aquarium Kaiyukan", notes: "今日有雨，室內行程剛剛好！必看：鯨鯊。", highlight: "雨天備案完美" },
                    { time: "13:30", title: "午餐：鶴橋風月", type: "food", location: "Tempozan Marketplace", notes: "位於天保山購物中心，大阪燒名店", mustEat: "大阪燒" },
                    { time: "15:30", title: "天神橋筋商店街", type: "shopping", location: "Tenjinbashisuji Shopping Street", notes: "日本最長商店街，有遮雨棚，逛街不受影響！", mustBuy: "便宜藥妝、水果" },
                    { time: "16:30", title: "許願：弁才天大福", type: "food", location: "Kakuozan Fruit Daifuku Benzaiten", notes: "南森町店順路。斷面超美的水果大福", mustEat: "季節限定水果大福" },
                    { time: "17:30", title: "民宿 Check-in", type: "hotel", location: "Seian Building", notes: "Seian Building。預訂代號：5599046120" },
                    { time: "18:30", title: "晚餐：心齋橋周邊", type: "food", location: "Shinsaibashi", notes: "避開道頓堀中心。推薦：鳥貴族(串燒)或巷弄居酒屋" }
                ]
            },
            {
                day: 4,
                date: "12/5 (五)",
                title: "京都賞楓 (優化路線)",
                weather: "rainy", // 陰有短暫雨
                temp: "4°C - 11°C",
                weatherDesc: "陰短暫雨 60%",
                weatherAlert: "氣溫驟降！注意保暖並帶傘",
                events: [
                    { time: "09:00", title: "包車出發", type: "transport", location: "Seian Building", notes: "民宿門口接送" },
                    { time: "10:30", title: "真如堂 (賞楓)", type: "sightseeing", location: "Shinnyo-do Temple", notes: "紅葉秘境。若雨勢大可調整停留時間", highlight: "賞楓秘境" },
                    { time: "11:30", title: "下鴨神社 & 糺之森", type: "sightseeing", location: "Shimogamo Shrine", notes: "森林浴非常舒服，雨天別有一番風味" },
                    { time: "13:00", title: "午餐：市區雞料理", type: "food", location: "Torii (Kyoto)", notes: "とり伊 (親子丼/雞肉鍋) 或 名代豬排。暖暖身子。", mustEat: "親子丼 / 雞肉鍋" },
                    { time: "15:00", title: "Teamlab 光影展", type: "sightseeing", location: "teamLab: Resonating Microcosms", notes: "位於東寺附近，戶外展區留意天氣，室內互動適合小孩" },
                    { time: "16:30", title: "京都車站", type: "shopping", location: "Kyoto Station", notes: "伊勢丹B1買伴手禮，大階梯看聖誕樹", mustBuy: "北山茶之菓、阿闍梨餅" },
                    { time: "17:30", title: "晚餐：Wamon 釜飯", type: "food", location: "Wamon Kyoto", notes: "或拉麵小路。釜飯居酒屋需要確認訂位" }
                ]
            },
            {
                day: 5,
                date: "12/6 (六)",
                title: "北攝祈福 & 梅田聖誕",
                weather: "sunny", // 晴時多雲
                temp: "5°C - 12°C",
                weatherDesc: "晴時多雲",
                events: [
                    { time: "09:00", title: "早餐：しんぱち食堂", type: "food", location: "Shinpachi Shokudo Namba", notes: "美味的炭烤魚定食", mustEat: "烤魚定食" },
                    { time: "10:30", title: "勝尾寺 (包車)", type: "sightseeing", location: "Katsuoji Temple", notes: "天氣放晴！滿滿的不倒翁，買一個畫眼睛祈福！", highlight: "不倒翁寺" },
                    { time: "13:00", title: "午餐：Grand Front", type: "food", location: "Grand Front Osaka", notes: "梅田 Grand Front 南館 7-8F。推薦：喜助牛舌", mustEat: "牛舌 / 大阪燒" },
                    { time: "14:30", title: "梅田百貨巡禮", type: "shopping", location: "Daimaru Umeda", notes: "大丸13F：寶可夢/任天堂。阪急B1：精緻甜點", highlight: "購物戰場" },
                    { time: "17:30", title: "梅田聖誕市集", type: "sightseeing", location: "Umeda Sky Building", notes: "藍天大廈下方廣場，氣氛極佳", highlight: "聖誕必去" },
                    { time: "19:00", title: "晚餐：梅田周邊", type: "food", location: "LUCUA Osaka", notes: "週五人多，若無訂位建議去 LUCUA B2 美食街", highlight: "需預約" }
                ]
            },
            {
                day: 6,
                date: "12/7 (日)",
                title: "滿載而歸",
                weather: "sunny", // 晴時多雲
                temp: "6°C - 13°C",
                weatherDesc: "晴時多雲",
                events: [
                    { time: "08:00", title: "包車前往機場", type: "transport", location: "Kansai International Airport", notes: "直達第一航廈。Seian Building 10:00前需退房" },
                    { time: "09:00", title: "辦理登機 & 最後採買", type: "shopping", location: "KIX Duty Free", notes: "薯條三兄弟、白色戀人、酒類最後補貨" },
                    { time: "11:30", title: "起飛 IT285", type: "transport", location: "IT285 Flight", notes: "14:00 抵達高雄" }
                ]
            }
        ];

        // --- Data: Info ---
        const flightInfo = {
            outbound: { code: "IT284", date: "12/2 (二)", route: "高雄 KHH (06:55) → 大阪 KIX (10:40)" },
            inbound: { code: "IT285", date: "12/7 (六)", route: "大阪 KIX (11:30) → 高雄 KHH (14:00)" }
        };

        const hotelInfo = [
            {
                name: "Hotel Universal Port Vita",
                sub: "環球影城維塔港酒店",
                code: "6501492647",
                checkIn: "12/2 (二) 15:00 ~ 0:00",
                checkOut: "12/4 (四) 11:00 前",
                address: "Hotel Universal Port Vita",
                note: "環球影城步行可達"
            },
            {
                name: "Seian Building",
                sub: "民宿",
                code: "5599046120",
                checkIn: "12/4 (四) 16:00 ~ 23:30",
                checkOut: "12/7 (日) 10:00 前",
                address: "Seian Building Osaka",
                note: "位於心齋橋/長堀橋周邊"
            }
        ];

        const emergencyInfo = [
            { label: "台灣駐日辦事處", value: "+81-3-3280-7811" },
            { label: "日本救護車/火警", value: "119" },
            { label: "日本報警", value: "110" },
            { label: "旅外國人急難救助", value: "+886-800-085-095" }
        ];

        // --- Components ---

        const WeatherIcon = ({ type }) => {
            if (type === 'sunny') return <Sun className="w-5 h-5 text-orange-500" />;
            if (type === 'rainy') return <CloudRain className="w-5 h-5 text-blue-500" />;
            if (type === 'cloudy') return <Cloud className="w-5 h-5 text-gray-500" />;
            return <Cloud className="w-5 h-5 text-gray-400" />;
        };

        const EventIcon = ({ type }) => {
            const classes = "w-5 h-5";
            switch(type) {
                case 'food': return <Utensils className={`${classes} text-red-700`} />;
                case 'transport': return <Train className={`${classes} text-blue-700`} />;
                case 'sightseeing': return <Camera className={`${classes} text-green-700`} />;
                case 'shopping': return <ShoppingBag className={`${classes} text-purple-700`} />;
                case 'hotel': return <Home className={`${classes} text-stone-600`} />;
                case 'strategy': return <Star className={`${classes} text-yellow-600`} />;
                default: return <Info className={classes} />;
            }
        };

        // --- Views ---

        const ItineraryView = () => {
            const [expandedDay, setExpandedDay] = useState(1); // Default Day 1 open

            const toggleDay = (day) => {
                setExpandedDay(expandedDay === day ? null : day);
            };

            const handleNavigate = (location) => {
                const query = encodeURIComponent(location);
                window.open(`https://www.google.com/maps/search/?api=1&query=${query}`, '_blank');
            };

            return (
                <div className="pb-24 pt-4 px-4 space-y-4 max-w-md mx-auto">
                    <h1 className="text-2xl font-serif text-stone-800 font-bold text-center mb-6">大阪京都六日冬旅</h1>
                    
                    {itineraryData.map((dayData) => (
                        <div key={dayData.day} className="bg-white rounded-xl shadow-sm border border-stone-200 overflow-hidden transition-all duration-300">
                            {/* Day Header */}
                            <div 
                                onClick={() => toggleDay(dayData.day)}
                                className={`p-4 flex flex-col cursor-pointer ${expandedDay === dayData.day ? 'bg-stone-50' : 'bg-white'}`}
                            >
                                <div className="flex items-center justify-between w-full mb-2">
                                    <div className="flex items-center space-x-3">
                                        <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold font-serif ${expandedDay === dayData.day ? 'bg-red-800 text-white' : 'bg-stone-100 text-stone-500'}`}>
                                            D{dayData.day}
                                        </div>
                                        <div>
                                            <div className="text-xs text-stone-500 font-medium">{dayData.date}</div>
                                            <div className="text-stone-800 font-bold">{dayData.title}</div>
                                        </div>
                                    </div>
                                    {expandedDay === dayData.day ? <ChevronUp className="w-5 h-5 text-stone-400"/> : <ChevronDown className="w-5 h-5 text-stone-400"/>}
                                </div>
                                
                                {/* Weather Bar inside Header */}
                                <div className="flex items-center justify-between bg-stone-100 rounded-lg p-2 text-xs text-stone-600">
                                    <div className="flex items-center space-x-2">
                                        <WeatherIcon type={dayData.weather} />
                                        <span className="font-medium">{dayData.weatherDesc}</span>
                                    </div>
                                    <div className="flex items-center">
                                        <Thermometer className="w-3 h-3 mr-1 text-stone-400" />
                                        {dayData.temp}
                                    </div>
                                </div>
                                {dayData.weatherAlert && (
                                    <div className="mt-1 flex items-center text-xs text-blue-600 font-medium animate-pulse">
                                        <Umbrella className="w-3 h-3 mr-1" />
                                        {dayData.weatherAlert}
                                    </div>
                                )}
                            </div>

                            {/* Timeline Events */}
                            {expandedDay === dayData.day && (
                                <div className="p-4 border-t border-stone-100 bg-[#fdfcf8]">
                                    <div className="relative pl-4 border-l-2 border-stone-200 space-y-8 py-2">
                                        {dayData.events.map((event, idx) => (
                                            <div key={idx} className="relative">
                                                {/* Timeline Dot */}
                                                <div className="absolute -left-[21px] top-1 bg-white border-2 border-stone-300 rounded-full p-1">
                                                    <div className="w-2 h-2 rounded-full bg-stone-300"></div>
                                                </div>
                                                
                                                {/* Time & Title */}
                                                <div className="flex justify-between items-start mb-1">
                                                    <span className="text-xs font-bold text-red-800 bg-red-50 px-2 py-0.5 rounded">{event.time}</span>
                                                    <EventIcon type={event.type} />
                                                </div>
                                                
                                                <h3 className="font-bold text-stone-800 text-lg leading-tight mb-2">{event.title}</h3>
                                                
                                                {/* Notes & Tags */}
                                                <div className="space-y-2 mb-3">
                                                    <p className="text-sm text-stone-600 leading-relaxed">{event.notes}</p>
                                                    
                                                    <div className="flex flex-wrap gap-2">
                                                        {event.highlight && (
                                                            <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800">
                                                                <Star className="w-3 h-3 mr-1" /> {event.highlight}
                                                            </span>
                                                        )}
                                                        {event.mustEat && (
                                                            <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800">
                                                                <Utensils className="w-3 h-3 mr-1" /> 必吃: {event.mustEat}
                                                            </span>
                                                        )}
                                                        {event.mustBuy && (
                                                            <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800">
                                                                <ShoppingBag className="w-3 h-3 mr-1" /> 必買: {event.mustBuy}
                                                            </span>
                                                        )}
                                                    </div>
                                                </div>

                                                {/* Navigate Button */}
                                                <button 
                                                    onClick={(e) => { e.stopPropagation(); handleNavigate(event.location); }}
                                                    className="flex items-center justify-center w-full py-2 bg-white border border-stone-300 rounded-lg text-sm text-stone-600 font-medium hover:bg-stone-50 active:bg-stone-100 transition-colors shadow-sm"
                                                >
                                                    <Navigation className="w-4 h-4 mr-2 text-blue-600" />
                                                    導航去這裡
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    ))}
                    
                    <div className="text-center text-xs text-stone-400 pt-8 pb-4">
                        行程僅供參考，請依現場狀況彈性調整
                    </div>
                </div>
            );
        };

        const InfoView = () => {
             const handleNavigate = (location) => {
                const query = encodeURIComponent(location);
                window.open(`https://www.google.com/maps/search/?api=1&query=${query}`, '_blank');
            };
            const openWeather = () => {
                window.open('https://weather.yahoo.co.jp/weather/jp/27/6200.html', '_blank');
            };

            return (
                <div className="pb-24 pt-4 px-4 space-y-6 max-w-md mx-auto">
                    <h1 className="text-2xl font-serif text-stone-800 font-bold text-center mb-6">旅程資訊</h1>
                    
                    {/* Weather Button */}
                    <div className="bg-gradient-to-r from-blue-500 to-blue-400 rounded-xl shadow-sm text-white p-5 cursor-pointer hover:opacity-90 transition" onClick={openWeather}>
                        <div className="flex items-center justify-between">
                            <div className="flex items-center">
                                <Thermometer className="w-8 h-8 mr-3" />
                                <div>
                                    <div className="font-bold text-lg">即時天氣預報</div>
                                    <div className="text-xs text-blue-100">點擊查看 Yahoo! JP 大阪氣象</div>
                                </div>
                            </div>
                            <Sun className="w-6 h-6 animate-pulse" />
                        </div>
                    </div>

                    {/* Flights */}
                    <div className="bg-white rounded-xl shadow-sm border border-stone-200 p-5">
                        <h2 className="flex items-center text-lg font-bold text-stone-800 mb-4">
                            <Plane className="w-5 h-5 mr-2 text-blue-700" /> 航班資訊
                        </h2>
                        <div className="space-y-4">
                            <div className="border-l-4 border-blue-500 pl-3">
                                <div className="text-xs text-stone-500">去程 {flightInfo.outbound.date}</div>
                                <div className="font-bold text-lg text-stone-800">{flightInfo.outbound.code}</div>
                                <div className="text-sm text-stone-600">{flightInfo.outbound.route}</div>
                            </div>
                            <div className="border-l-4 border-orange-500 pl-3">
                                <div className="text-xs text-stone-500">回程 {flightInfo.inbound.date}</div>
                                <div className="font-bold text-lg text-stone-800">{flightInfo.inbound.code}</div>
                                <div className="text-sm text-stone-600">{flightInfo.inbound.route}</div>
                            </div>
                        </div>
                    </div>

                    {/* Hotels */}
                    <div className="bg-white rounded-xl shadow-sm border border-stone-200 p-5">
                        <h2 className="flex items-center text-lg font-bold text-stone-800 mb-4">
                            <Home className="w-5 h-5 mr-2 text-green-700" /> 住宿資訊
                        </h2>
                        <div className="space-y-6">
                            {hotelInfo.map((hotel, idx) => (
                                <div key={idx} className="relative pl-4 border-l-2 border-stone-200">
                                    <div className="absolute -left-[7px] top-0 w-3 h-3 bg-stone-200 rounded-full"></div>
                                    <h3 className="font-bold text-stone-800 leading-tight">{hotel.name}</h3>
                                    <div className="text-xs text-stone-500 mb-2">{hotel.sub}</div>
                                    
                                    <div className="bg-stone-50 p-3 rounded-lg border border-stone-100 mb-3">
                                        <div className="text-xs text-stone-400 mb-1">預訂確認碼</div>
                                        <div className="font-mono font-bold text-red-700 text-lg select-all">{hotel.code}</div>
                                    </div>

                                    <div className="space-y-1 text-sm text-stone-600 mb-3">
                                        <div className="flex justify-between"><span>入住:</span> <span className="font-medium">{hotel.checkIn}</span></div>
                                        <div className="flex justify-between"><span>退房:</span> <span className="font-medium">{hotel.checkOut}</span></div>
                                    </div>

                                    <button 
                                        onClick={() => handleNavigate(hotel.address)}
                                        className="w-full py-1.5 bg-white border border-stone-300 rounded text-xs text-stone-600 font-medium hover:bg-stone-50 flex items-center justify-center"
                                    >
                                        <Navigation className="w-3 h-3 mr-1" /> 導航至飯店
                                    </button>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Emergency */}
                    <div className="bg-white rounded-xl shadow-sm border border-stone-200 p-5">
                        <h2 className="flex items-center text-lg font-bold text-stone-800 mb-4">
                            <AlertCircle className="w-5 h-5 mr-2 text-red-700" /> 緊急聯絡
                        </h2>
                        <div className="space-y-3">
                            {emergencyInfo.map((item, idx) => (
                                <div key={idx} className="flex justify-between items-center py-2 border-b border-stone-100 last:border-0">
                                    <span className="text-sm text-stone-600">{item.label}</span>
                                    <a href={`tel:${item.value}`} className="text-blue-600 font-bold font-mono">{item.value}</a>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const BudgetView = () => {
            const [items, setItems] = useState([
                { id: 1, title: 'Haruka 車票 (範例)', amount: 3600, type: 'transport' },
                { id: 2, title: 'USJ 門票 (範例)', amount: 18000, type: 'ticket' },
            ]);
            const [newItem, setNewItem] = useState({ title: '', amount: '' });
            const [currency, setCurrency] = useState('JPY'); // Default to JPY

            const addItem = () => {
                if(!newItem.title || !newItem.amount) return;
                setItems([...items, { id: Date.now(), title: newItem.title, amount: parseInt(newItem.amount), type: 'other' }]);
                setNewItem({ title: '', amount: '' });
            };

            const deleteItem = (id) => {
                setItems(items.filter(item => item.id !== id));
            };

            const total = items.reduce((sum, item) => sum + item.amount, 0);

            return (
                <div className="pb-24 pt-4 px-4 space-y-6 max-w-md mx-auto">
                    <h1 className="text-2xl font-serif text-stone-800 font-bold text-center mb-6">預算記帳</h1>
                    
                    {/* Currency Toggle */}
                    <div className="flex justify-center space-x-4 mb-4">
                        <button 
                            onClick={() => setCurrency('JPY')}
                            className={`px-4 py-1 rounded-full text-sm font-medium transition-colors ${currency === 'JPY' ? 'bg-red-800 text-white' : 'bg-stone-200 text-stone-600'}`}
                        >
                            日幣 (JPY)
                        </button>
                        <button 
                            onClick={() => setCurrency('TWD')}
                            className={`px-4 py-1 rounded-full text-sm font-medium transition-colors ${currency === 'TWD' ? 'bg-red-800 text-white' : 'bg-stone-200 text-stone-600'}`}
                        >
                            台幣 (TWD)
                        </button>
                    </div>

                    {/* Total Card */}
                    <div className="bg-stone-800 text-white rounded-xl shadow-lg p-6 text-center relative overflow-hidden transition-all">
                        <div className="absolute top-0 right-0 p-4 opacity-10"><Wallet size={64} /></div>
                        <div className="text-sm text-stone-300 mb-1">目前總花費 ({currency})</div>
                        <div className="text-4xl font-mono font-bold">
                            {currency === 'JPY' ? '¥' : 'NT$'} {total.toLocaleString()}
                        </div>
                    </div>

                    {/* Add Item */}
                    <div className="bg-white rounded-xl shadow-sm border border-stone-200 p-4 flex space-x-2">
                        <input 
                            type="text" 
                            placeholder="項目" 
                            className="flex-1 p-2 bg-stone-50 border border-stone-200 rounded text-sm outline-none focus:border-stone-400"
                            value={newItem.title}
                            onChange={e => setNewItem({...newItem, title: e.target.value})}
                        />
                        <input 
                            type="number" 
                            placeholder="金額" 
                            className="w-24 p-2 bg-stone-50 border border-stone-200 rounded text-sm outline-none focus:border-stone-400"
                            value={newItem.amount}
                            onChange={e => setNewItem({...newItem, amount: e.target.value})}
                        />
                        <button 
                            onClick={addItem}
                            className="bg-stone-800 text-white p-2 rounded hover:bg-stone-700 w-10 flex items-center justify-center"
                        >
                            +
                        </button>
                    </div>

                    {/* List */}
                    <div className="bg-white rounded-xl shadow-sm border border-stone-200 overflow-hidden">
                        {items.map(item => (
                            <div key={item.id} className="flex justify-between items-center p-4 border-b border-stone-100 last:border-0 group">
                                <span className="text-stone-700">{item.title}</span>
                                <div className="flex items-center space-x-3">
                                    <span className="font-mono font-bold text-stone-900">
                                        {currency === 'JPY' ? '¥' : 'NT$'} {item.amount.toLocaleString()}
                                    </span>
                                    <button 
                                        onClick={() => deleteItem(item.id)}
                                        className="text-stone-300 hover:text-red-500 transition-colors"
                                    >
                                        ×
                                    </button>
                                </div>
                            </div>
                        ))}
                        {items.length === 0 && <div className="p-8 text-center text-stone-400 text-sm">暫無記帳資料</div>}
                    </div>
                </div>
            );
        }

        const App = () => {
            const [activeTab, setActiveTab] = useState('itinerary'); // itinerary, info, budget

            return (
                <div className="min-h-screen pb-safe">
                    {/* Main Content Area */}
                    <main>
                        {activeTab === 'itinerary' && <ItineraryView />}
                        {activeTab === 'info' && <InfoView />}
                        {activeTab === 'budget' && <BudgetView />}
                    </main>

                    {/* Bottom Navigation Bar */}
                    <nav className="fixed bottom-0 w-full glass-nav z-50 pb-safe">
                        <div className="flex justify-around items-center h-16 max-w-md mx-auto">
                            <button 
                                onClick={() => setActiveTab('itinerary')}
                                className={`flex flex-col items-center justify-center w-full h-full space-y-1 ${activeTab === 'itinerary' ? 'text-red-800' : 'text-stone-400'}`}
                            >
                                <Calendar className="w-6 h-6" />
                                <span className="text-[10px] font-medium">行程</span>
                            </button>
                            <button 
                                onClick={() => setActiveTab('info')}
                                className={`flex flex-col items-center justify-center w-full h-full space-y-1 ${activeTab === 'info' ? 'text-red-800' : 'text-stone-400'}`}
                            >
                                <Info className="w-6 h-6" />
                                <span className="text-[10px] font-medium">資訊</span>
                            </button>
                            <button 
                                onClick={() => setActiveTab('budget')}
                                className={`flex flex-col items-center justify-center w-full h-full space-y-1 ${activeTab === 'budget' ? 'text-red-800' : 'text-stone-400'}`}
                            >
                                <Wallet className="w-6 h-6" />
                                <span className="text-[10px] font-medium">記帳</span>
                            </button>
                        </div>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
